<%= render 'common/search' %>
<%= flash_notice %>

<table>
  <tr>
    <th>勘定科目</th>
    <th>補助科目</th>
    <th>期末残高</th>
    <th>事業費率</th>
    <th>家事比率</th>
    <th>家事振替額</th>
    <th></th>
  </tr>
  
  <% @hw.details.each do |hwd| %>
    <tr>
      <td align="center"><%= hwd.account.name %></td>
      <td align="center"><%= hwd.sub_account.name if hwd.sub_account %></td>
      <td align="right"><%= to_amount(hwd.net_sum_amount, :show_zero=>true) %></td>
      <td align="center"><%= hwd.business_ratio %>%</td>
      <td align="center"><%= 100 - hwd.business_ratio %>%</td>
      <% if @hw.journal_headers.size > 0 %>
      <td align="right">
        <%= to_amount(hwd.housework_amount, :show_zero => true) %>
      </td>
      <% else %>
      <td align="center">
        未処理
      </td>
      <% end %>
      <td>
        <%= link_to '編集', edit_housework_housework_detail_path(@hw, hwd), :remote => true %>
        <%= link_to '削除', housework_housework_detail_path(@hw, hwd), :confirm => '削除します。よろしいですか？', :method => :delete %>
      </td>
    </tr>
  <% end %>
</table>

<div style="margin: 10px;">
  <%= link_to '追加', new_housework_housework_detail_path(@hw), :remote => true %>
  <% if @hw.details.present? %>
    |
    <%= link_to '仕訳作成', {:action => :create_journal, :id => @hw}, :confirm => '家事按分仕訳を作成します。よろしいですか？', :method => :post %>
  <% end %>
</div>

